<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <link rel="stylesheet" th:href="@{/css/main.css}">
    <link rel="stylesheet" th:href="@{/css/buttons.css}">
    <link rel="stylesheet" th:href="@{/css/memberDetail.css}">
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
    <!--    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
</head>
<body>
<div th:replace="/components/header :: header"></div>
<div id="member-detail-section" style="margin-top: 150px">
    <table class="top-table">
        <tr>
            <th>νμ›μ •λ³΄</th>
            <th>
                <button class="btn-2" onclick="member_update()" title="μ •λ³΄μμ •"><i class="bi bi-pencil-square"></i>
                </button>
                <button class="btn-2" onclick="member_list()" th:if="${user.memberId} == 'admin'">νμ›λ©λ΅</button>
                <button class="btn-2" onclick="member_delete()" th:if="${user.memberId} == 'admin'">νμ›μ‚­μ </button>
            </th>
        </tr>
    </table>

    <table class="member-table">
        <tr style="display: none">
            <th>κ°€μ…λ²νΈ</th>
            <td th:text="${user.id}"></td>
        </tr>
        <tr>
            <th>ID</th>
            <td th:text="${user.memberId}"></td>
        </tr>
        <tr>
            <th>E-mail</th>
            <td th:text="${user.memberEmail}"></td>
        </tr>
        <tr>
            <th>λΉ„λ°€λ²νΈ</th>
            <td th:text="${user.memberPassword}" style="display: none"></td>
            <td style="color: #00d01b"> β… μ•μ „ν•κ² λ³΄νΈλκ³  μμµλ‹λ‹¤.</td>
        </tr>
        <tr>
            <th>μ΄λ¦„</th>
            <td th:text="${user.memberName}"></td>
        </tr>
        <tr>
            <th>μƒλ…„μ›”μΌ</th>
            <td th:text="${user.memberBirth}"></td>
        </tr>
        <tr>
            <th>μ „ν™”λ²νΈ</th>
            <td th:text="${user.memberMobile}"></td>
        </tr>
        <tr>
            <th>νμ›νƒν‡΄</th>
            <td>
                <button class="btn-3-danger" onclick="member_delete()">νμ›νƒν‡΄</button>
            </td>
        </tr>
    </table>

    <table class="top-table">
        <th> ν¬μΈνΈ λ‚΄μ—­</th>
    </table>
    <table class="point-table">
        <tr style="display: none">
            <th>λΉ„λ°€λ²νΈ</th>
            <td th:text="${user.memberPassword}"></td>
        </tr>
        <tr>
            <th id="cash-icon"><i class="bi bi-currency-exchange"></i></th>
        </tr>
        <tr>
            <th id="you-have-n-points">
                <span th:text="${user.memberId}"></span> λ‹μ΄ λ³΄μ ν•μ‹  ν¬μΈνΈ
            </th>
        </tr>
        <tr>
            <th id="points-amount">
                <span th:text="${user.totalPoint}"></span> POINT
            </th>
        </tr>
        <tr>
            <th id="charge-list">
                <button class="btn-3" onclick="point_charge()">μ¶©μ „ν•κΈ°</button>
                <button class="btn-3" onclick="point_history()">λ‚΄μ—­λ³΄κΈ°</button>
                <button class="btn-3" onclick="purchase_history()">κµ¬λ§¤λ‚΄μ—­</button>
                <button class="btn-3" onclick="sales_history()">νλ§¤λ‚΄μ—­</button>
            </th>
        </tr>
    </table>
    <table class="top-table">
        <th> λ©”μ‹ μ € </th>
    </table>
    <table class="messenger-table">
        <tr>
            <th>π’¬ HEXAGON κ²μ΄λ¨Έλ“¤κ³Ό μ†ν†µν•΄λ³΄μ„Έμ” </th>
        </tr>
        <tr>
            <td><button class="btn-5" onclick="messenger()">μ±„ν…λ°© μ…μ¥</button> </td>
        </tr>
    </table>
    <div class="pass-check">
    </div>
</div>

</div>
<div th:replace="/components/footer :: footer"></div>
</body>
<script th:inline="javascript">
    const member_list = () => {
        location.href = "/member/";
    }
    const member_update = () => {
        location.href = "/member/update"
    };

    const member_delete = () => {
        const id = [[${user.id}]];
        axios({
            method: "delete",
            url: "/member/delete/" + id,
            withCredentials: true // μΈμ¦ μ •λ³΄ ν¬ν•¨
        }).then(res => {
            location.href = "/";
        }).catch(err => {
            alert("μ‚­μ  μ‹¤ν¨");
        });
    };

    const point_charge = () => {
        // location.href = "/point/charge";
        window.open(
            "/point/charge",
            "HEXAGON ν¬μΈνΈ μ¶©μ „",
            "width=530, height=625, top=50, left=50"
        )
    }
    const point_history = () => {
        location.href = "/point/history";
    }

    const messenger = () => {
        window.open(
            "/chat/rooms",
            "HEXAGON λ©”μ‹ μ €",
            "width=550, height=800, top=50, left=50"
        )
    }
    // λ©”μ‹μ§€ μ΄λ²¤νΈ λ¦¬μ¤λ„ λ“±λ΅
    window.addEventListener("message", function (event) {
        if (event.data === "chargeComplete") {
            // μ¶©μ „μ΄ μ™„λ£λμ—λ‹¤λ” λ©”μ‹μ§€λ¥Ό λ°›μΌλ©΄ μƒλ΅κ³ μΉ¨
            location.reload();
        }
    });

    const purchase_history = () => {
        location.href = "/purchase/history";
    }

    const sales_history = () => {
        location.href = "";
    }
</script>
</html>